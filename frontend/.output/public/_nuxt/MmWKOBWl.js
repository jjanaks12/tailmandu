import{c as w}from"./DkQOv5sH.js";import{aR as T,r as f,K as E,ac as C,E as I,X as O,e as P,M as U,Y as S,U as x}from"./BWYtlrHP.js";import{r as b}from"./IQQXW68s.js";import{e as R,i as _,d as $}from"./DHK_nE_D.js";function Y(){let e=document.activeElement;if(e==null)return null;for(;e!=null&&e.shadowRoot!=null&&e.shadowRoot.activeElement!=null;)e=e.shadowRoot.activeElement;return e}const[q,K]=w("ConfigProvider");function X(e,t="reka"){return e||`${t}-${T?.()}`}function D(e,t){const r=f(e);function l(s){return t[r.value][s]??r.value}return{state:r,dispatch:s=>{r.value=l(s)}}}function F(e,t){const r=f({}),l=f("none"),v=f(e),s=e.value?"mounted":"unmounted";let u;const c=t.value?.ownerDocument.defaultView??R,{state:m,dispatch:i}=D(s,{mounted:{UNMOUNT:"unmounted",ANIMATION_OUT:"unmountSuspended"},unmountSuspended:{MOUNT:"mounted",ANIMATION_END:"unmounted"},unmounted:{MOUNT:"mounted"}}),a=n=>{if(_){const o=new CustomEvent(n,{bubbles:!1,cancelable:!1});t.value?.dispatchEvent(o)}};E(e,async(n,o)=>{const N=o!==n;if(await O(),N){const A=l.value,d=h(t.value);n?(i("MOUNT"),a("enter"),d==="none"&&a("after-enter")):d==="none"||d==="undefined"||r.value?.display==="none"?(i("UNMOUNT"),a("leave"),a("after-leave")):o&&A!==d?(i("ANIMATION_OUT"),a("leave")):(i("UNMOUNT"),a("after-leave"))}},{immediate:!0});const p=n=>{const o=h(t.value),N=o.includes(n.animationName),A=m.value==="mounted"?"enter":"leave";if(n.target===t.value&&N&&(a(`after-${A}`),i("ANIMATION_END"),!v.value)){const d=t.value.style.animationFillMode;t.value.style.animationFillMode="forwards",u=c?.setTimeout(()=>{t.value?.style.animationFillMode==="forwards"&&(t.value.style.animationFillMode=d)})}n.target===t.value&&o==="none"&&i("ANIMATION_END")},M=n=>{n.target===t.value&&(l.value=h(t.value))},y=E(t,(n,o)=>{n?(r.value=getComputedStyle(n),n.addEventListener("animationstart",M),n.addEventListener("animationcancel",p),n.addEventListener("animationend",p)):(i("ANIMATION_END"),u!==void 0&&c?.clearTimeout(u),o?.removeEventListener("animationstart",M),o?.removeEventListener("animationcancel",p),o?.removeEventListener("animationend",p))},{immediate:!0}),g=E(m,()=>{const n=h(t.value);l.value=m.value==="mounted"?n:"none"});return C(()=>{y(),g()}),{isPresent:I(()=>["mounted","unmountSuspended"].includes(m.value))}}function h(e){return e&&getComputedStyle(e).animationName||"none"}var z=P({name:"Presence",props:{present:{type:Boolean,required:!0},forceMount:{type:Boolean}},slots:{},setup(e,{slots:t,expose:r}){const{present:l,forceMount:v}=U(e),s=f(),{isPresent:u}=F(l,s);r({present:u});let c=t.default({present:u.value});c=b(c||[]);const m=S();if(c&&c?.length>1){const i=m?.parent?.type.name?`<${m.parent.type.name} />`:"component";throw new Error([`Detected an invalid children for \`${i}\` for  \`Presence\` component.`,"","Note: Presence works similarly to `v-if` directly, but it waits for animation/transition to finished before unmounting. So it expect only one direct child of valid VNode type.","You can apply a few solutions:",["Provide a single child element so that `presence` directive attach correctly.","Ensure the first child is an actual element instead of a raw text node or comment node."].map(a=>`  - ${a}`).join(`
`)].join(`
`))}return()=>v.value||l.value||u.value?x(t.default({present:u.value})[0],{ref:i=>{const a=$(i);return typeof a?.hasAttribute>"u"||(a?.hasAttribute("data-reka-popper-content-wrapper")?s.value=a.firstElementChild:s.value=a),a}}):null}});export{z as P,Y as g,q as i,X as u};
