import{_ as S}from"./DTXbyeut.js";import{_ as j}from"./BRiKR8X3.js";import{_ as P}from"./DhmB0p6i.js";import{a as U,b as Z,_ as q}from"./srK4LSmb.js";import{e as D,l as I,E as C,c,o as a,b as r,a as f,h as N,w as u,g as e,i as G,d as V,t as m,y as R,x as J,z as K,s as O,A as Q,r as k,p as W,F as x,v as T,Z as X,f as A}from"./D91ZHywZ.js";import{a as ee}from"./CZanlJpN.js";import{_ as te,a as ne,b as se}from"./BKmfb-s-.js";import{u as ae}from"./Dnv01NYR.js";import{R as oe}from"./99ZdcTmU.js";import{T as re}from"./Bg4jYszT.js";import"./C6WeEH23.js";import"./CPYLdFy8.js";import"./DWuPLQul.js";import"./DQi6vIwO.js";import"./Dx2IEVPb.js";import"./DBMhBydG.js";const le={class:"text-center space-y-2"},ie={class:"block"},ce={class:"not-italic text-3xl text-black block"},ue={key:0,class:"block"},me=D({__name:"Runner",props:{runner:{},timer:{},stageId:{}},emits:["update"],setup(s,{emit:p}){const _=p,l=s,{axios:g}=I(),d=C(()=>[l.runner.personal.first_name,l.runner.personal.middle_name,l.runner.personal.last_name].join(" ")),i=async()=>{l.timer==null&&(await g.post(`/volunteers/${l.runner.stage_category_id}/log_timer/${l.runner.id}`),_("update"))};return(y,$)=>{const h=U,v=Z,w=q;return a(),c("div",le,[r(w,{class:R({"size-[120px] mx-auto border-4":!0,"border-primary":s.timer==null,"border-secondary":s.timer!==void 0}),onClick:i},{default:u(()=>[r(h,{src:e(G)(s.runner.personal?.avatar?.file_name),alt:s.runner.personal.first_name},null,8,["src","alt"]),r(v,null,{default:u(()=>[V(m(e(ee)(e(d))),1)]),_:1})]),_:1},8,["class"]),f("strong",ie,m(e(d)),1),f("em",ce,m(s.runner.bib),1),s.timer?(a(),c("span",ue,m(e(J)(s.timer).format("YYYY-MM-DD HH:mm:ss")),1)):N("",!0),f("span",{class:R({flag:!0,["flag-"+s.runner.personal.country.abbr]:!0})},null,2)])}}}),de={class:"flex justify-end items-center gap-4 pb-4 mb-14 border-b"},_e={key:0,class:"flex gap-4"},Te=D({__name:"[stage_id]",setup(s){ae({title:"Volunteer"});const{axios:p}=I(),_=K(),{user:l}=O(Q()),g=k([]),d=k([]),i=k(""),y=k([]),$=C(()=>{let t=null;for(const n of l.value?.personal?.volunteers??[])for(const b of n.checkpoints)b.stage_category.stage_id==_.params.stage_id&&(t=b);return t}),h=async()=>{if($.value){const{data:t}=await p.get(`/volunteers/checkpoints/${$.value.id}/entry`);d.value=t}},v=async()=>{const{data:t}=await p.get(`/events/stages/${_.params.stage_id}/runners`);y.value=t,g.value=t.map(n=>n.runners).flat(),h()},w=t=>d.value.find(n=>n.runner_id===t)??null,B=C(()=>g.value.filter(t=>t.bib.includes(i.value)));return W(()=>{v()}),(t,n)=>{const b=S,z=j,Y=P,E=me,F=ne,H=se,L=te;return a(),c(x,null,[f("div",de,[(a(!0),c(x,null,T(e(y),o=>(a(),A(b,{key:o.id,variant:"outline"},{default:u(()=>[V(m(o.name)+" (total: "+m(o.runners.length)+") (remaining: "+m(o.runners.length-e(d).filter(M=>M.timer!==null).length)+") ",1)]),_:2},1024))),128)),r(z,{modelValue:e(i),"onUpdate:modelValue":n[0]||(n[0]=o=>X(i)?i.value=o:null),placeholder:"Search by BIB ID here...",class:"max-w-[280px]"},null,8,["modelValue"]),r(Y,{type:"button",onClick:v,size:"icon",modifier:"outline"},{default:u(()=>[r(e(oe))]),_:1})]),e(B).length>0?(a(),c("div",_e,[(a(!0),c(x,null,T(e(B),o=>(a(),A(E,{timer:w(o.id)?.timer,"stage-id":e(_).params.stage_id,runner:o,class:"w-1/2 md:w-1/3 lg:w-1/4",onUpdate:h},null,8,["timer","stage-id","runner"]))),256))])):(a(),c(x,{key:1},[e(i)?(a(),A(L,{key:0,variant:"info"},{default:u(()=>[r(e(re)),r(F,{class:"text-lg"},{default:u(()=>[...n[1]||(n[1]=[V("No runners found!",-1)])]),_:1}),r(H,null,{default:u(()=>[...n[2]||(n[2]=[f("p",null,"Please check on your search, there might be some typo.",-1)])]),_:1})]),_:1})):N("",!0)],64))],64)}}});export{Te as default};
